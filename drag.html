<!DOCTYPE HTML>
<html>
<head>
<style>
#div1, #div2 {
    float: left;
    width: 500px;
    height: 150px;
    margin: 10px;
    padding: 10px;
    border: 1px solid black;
}
</style>

</head>
<body>

<h2>Drag and Drop</h2>
<p>Drag the image back and forth between the two div elements.</p>

<div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)">

    <p id="drag1"draggable="true" ondragstart="drag(event)" width="88" height="31">drag me</p>

</div>

<div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="leave(event)"></div>

<input id="button" title="New" type="submit" value="New">

<script>

    //http://plnkr.co/edit/qwrhqAarRXyJCEeqCJGl?p=preview !!
    var divOne = document.getElementById('div1');
 /*   var isin;

    var ball = document.getElementById('drag1');
    var divOne = document.getElementById('div1');
    var divTwo = document.getElementById('div2');

    ball.style.position = 'relative';
    ball.style.zIndex = 1000;

    ball.onmousedown = function (e) {
        // над другими элементами

       // console.log(isin);
//            function moveAt(e) {
//
//            }

        var coords = getCoords(ball);
        var divCoords = getCoords(divTwo);
        var shiftX = e.pageX - coords.left;
        var shiftY = e.pageY - coords.top;

            document.onmousemove = function (e) {
                //moveAt(e);
                var newLeft = e.pageX - shiftX - divCoords.left;
                var newTop = e.pageY - shiftY - divCoords.top;


                if (newLeft < 0) {
                    leave();
                    return ;
                }

                if (newTop < 0) {
                    leave();
                    return ;
                }

                var rightEdge = divTwo.offsetWidth - ball.offsetWidth;
                console.log(rightEdge);
                if (newLeft > rightEdge) {
                    leave();
                    return ;
                }

                var bottomEdge = divTwo.offsetHeight - ball.offsetHeight;

                if (newTop > bottomEdge) {
                    leave();
                    return ;
                }
                if (isin == "div2") {
                    ball.style.left = newLeft + 'px';
                    ball.style.top = newTop + 'px';
                }

            };

            ball.onmouseup = function () {
                document.onmousemove = null;
                document.onmouseup = null;
            };

            ball.ondragstart = function () {
                return false;
            };
            return false;
    }
*/
    function getCoords(elem) {   // кроме IE8-
        var box = elem.getBoundingClientRect();
        return {
            top: box.top + pageYOffset,
            left: box.left + pageXOffset
        };
    }

    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev) {
        //var coords = getCoords(ev.target);
        //var divCoords = getCoords(divTwo);
        ev.dataTransfer.setData("text", ev.target.id);
    }

    function drop(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData("text");
        isin = ev.target.id;
        alert(isin);

        ev.target.appendChild(document.getElementById(data));
    }

    function leave() {
        divOne.appendChild(document.getElementById('drag1'));
    }

    var isin;// = ev.target.id;

</script>

</body>
</html>
